
<h1>Submissions</h1>

<p><%= link_to 'New Submission', new_submission_path %></p>

<p>
  <%= form_tag(submissions_path, :method => "get", id: "search-form", class: 'form-inline') do %>
    <%# Add hidden sort and direction to persist these on a search. %>
    <%= hidden_field_tag :direction, params[:direction] %>
    <%= hidden_field_tag :sort, params[:sort] %>
    <div class="form-group">
      <%= text_field_tag :search, params[:search], placeholder: "Search Submissions", class:'form-control mr-2' %>
      <%= submit_tag "Search", :name => nil, class:'btn btn-primary mr-2' %>
      <%= link_to "Clear Search", { :action => "index" }, :method => :get, class:'btn btn-secondary' %>
    </div>
  <% end %>
</p>

<% if @submissions.blank? %>
  <div class="alert alert-danger" role="alert">
    There are no submissions containing the term "<%= params[:search] %>".
  </div>
<% end %>

<div id="submissions">
  <%= render 'submissions' %>
</div>

<table>
  <tr>
    <%# sortable is defined in application_helper %>
    <th><%= sortable "title" %></th>
    <th><%= sortable "translators.name", "Translator"%></th>
    <th><%= sortable "publication_year", "Year" %></th>
  </tr>

  <% @submissions.each do |submission| %>
    <tr>
      <td><%= truncate(submission.title, length: 75) %></td>
      <td><%= Translator.find(submission.translator_id).name %></td>
      <td><%= submission.publication_year %></td>
      <td><%= link_to 'Show', submission_path(submission) %> :
        <%= link_to 'Edit', edit_submission_path(submission) %> :
        <%= link_to 'Destroy', submission_path(submission),
           method: :delete,
           data: { confirm: 'Are you sure?' } %>
      </td>
    </tr>
  <% end %>

</table>
